<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ficha de Datos - Empresa Comunal Taca</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
  <div id="root"></div>
  
  <script type="text/babel">
    const { useState, useRef } = React;

    // Iconos SVG
    const ChevronDown = ({size=24}) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><polyline points="6 9 12 15 18 9"></polyline></svg>;
    const ChevronUp = ({size=24}) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><polyline points="18 15 12 9 6 15"></polyline></svg>;
    const User = ({size=24}) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg>;
    const Users = ({size=24}) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle><path d="M23 21v-2a4 4 0 0 0-3-3.87"></path><path d="M16 3.13a4 4 0 0 1 0 7.75"></path></svg>;
    const GraduationCap = ({size=24}) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M22 10v6M2 10l10-5 10 5-10 5z"></path><path d="M6 12v5c3 3 9 3 12 0v-5"></path></svg>;
    const Briefcase = ({size=24}) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><rect x="2" y="7" width="20" height="14" rx="2" ry="2"></rect><path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"></path></svg>;
    const Paperclip = ({size=24}) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48"></path></svg>;
    const CheckCircle = ({size=24}) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><polyline points="22 4 12 14.01 9 11.01"></polyline></svg>;
    const AlertCircle = ({size=24}) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="8" x2="12" y2="12"></line><line x1="12" y1="16" x2="12.01" y2="16"></line></svg>;
    const Building2 = ({size=24}) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z"></path><path d="M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2"></path><path d="M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2"></path><path d="M10 6h4"></path><path d="M10 10h4"></path><path d="M10 14h4"></path><path d="M10 18h4"></path></svg>;
    const Phone = ({size=24}) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path></svg>;
    const Mail = ({size=24}) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg>;
    const MapPin = ({size=24}) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path><circle cx="12" cy="10" r="3"></circle></svg>;
    const CreditCard = ({size=24}) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><rect x="1" y="4" width="22" height="16" rx="2" ry="2"></rect><line x1="1" y1="10" x2="23" y2="10"></line></svg>;
    const Calendar = ({size=24}) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>;
    const Heart = ({size=24}) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg>;
    const Baby = ({size=24}) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M9 12h.01"></path><path d="M15 12h.01"></path><path d="M10 16c.5.3 1.2.5 2 .5s1.5-.2 2-.5"></path><path d="M19 6.3a9 9 0 0 1 1.8 3.9 2 2 0 0 1 0 3.6 9 9 0 0 1-17.6 0 2 2 0 0 1 0-3.6A9 9 0 0 1 12 3c2 0 3.5 1.1 3.5 2.5s-.9 2.5-2 2.5c-.8 0-1.5-.4-1.5-1"></path></svg>;
    const UserPlus = ({size=24}) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="8.5" cy="7" r="4"></circle><line x1="20" y1="8" x2="20" y2="14"></line><line x1="23" y1="11" x2="17" y2="11"></line></svg>;
    const Book = ({size=24}) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path></svg>;
    const Award = ({size=24}) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="12" cy="8" r="7"></circle><polyline points="8.21 13.89 7 23 12 20 17 23 15.79 13.88"></polyline></svg>;
    const FileText = ({size=24}) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>;
    const Shield = ({size=24}) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path></svg>;

    function FichaDatos() {
      const [formData, setFormData] = useState({});
      const [expandedSections, setExpandedSections] = useState([0,1,2,3,4,5,6]);
      const [familiares, setFamiliares] = useState([{id:1}]);
      const [contactosEmergencia, setContactosEmergencia] = useState([{id:1}]);
      const [estudios, setEstudios] = useState([{id:1}]);
      const [experiencias, setExperiencias] = useState([{id:1}]);
      const [attachments, setAttachments] = useState({});
      const fileInputRefs = useRef({});

      const handleChange = (e) => {
        const {name,value} = e.target;
        setFormData(prev => ({...prev, [name]:value}));
      };

      const toggleSection = (id) => expandedSections.includes(id) ? setExpandedSections(prev=>prev.filter(s=>s!==id)) : setExpandedSections(prev=>[...prev,id]);

      const handleFileClick = (key) => {
        if(!fileInputRefs.current[key]) fileInputRefs.current[key]=React.createRef();
        fileInputRefs.current[key].current.click();
      };

      const handleFileChange = (key,e) => {
        const file=e.target.files[0];
        setAttachments(prev=>({...prev,[key]:file?file.name:null}));
      };

      const handleSubmit = async (e) => {
        e?.preventDefault();
        
        // ⚠️ REEMPLAZA CON TU URL DE GOOGLE APPS SCRIPT
        const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/TU_URL_AQUI/exec';
        
        const familiaresData = familiares.map(fam=>({
          nombres:formData[`familiar_${fam.id}_nombres`],
          apellido_paterno:formData[`familiar_${fam.id}_apellido_paterno`],
          apellido_materno:formData[`familiar_${fam.id}_apellido_materno`],
          dni:formData[`familiar_${fam.id}_dni`],
          parentesco:formData[`familiar_${fam.id}_parentesco`],
          fecha_nacimiento:formData[`familiar_${fam.id}_fecha_nacimiento`]
        }));

        const contactosData = contactosEmergencia.map(cont=>({
          nombre:formData[`contacto_${cont.id}_nombre`],
          vinculo:formData[`contacto_${cont.id}_vinculo`],
          celular:formData[`contacto_${cont.id}_celular`]
        }));

        const estudiosData = estudios.map(est=>({
          centro:formData[`estudio_${est.id}_centro`],
          carrera:formData[`estudio_${est.id}_carrera`],
          duracion:formData[`estudio_${est.id}_duracion`],
          ingreso:formData[`estudio_${est.id}_ingreso`],
          egreso:formData[`estudio_${est.id}_egreso`]
        }));

        const experienciasData = experiencias.map(exp=>({
          organizacion:formData[`exp_${exp.id}_org`],
          cargo:formData[`exp_${exp.id}_cargo`],
          tiempo:formData[`exp_${exp.id}_tiempo`],
          motivo:formData[`exp_${exp.id}_motivo`],
          jefe:formData[`exp_${exp.id}_jefe`],
          cargo_jefe:formData[`exp_${exp.id}_cargo_jefe`],
          telefono_jefe:formData[`exp_${exp.id}_telefono_jefe`]
        }));

        const datosCompletos = {...formData,familiares:familiaresData,contactos:contactosData,estudios:estudiosData,experiencias:experienciasData};

        try {
          alert('Enviando datos...');
          await fetch(GOOGLE_SCRIPT_URL,{method:'POST',mode:'no-cors',headers:{'Content-Type':'application/json'},body:JSON.stringify(datosCompletos)});
          alert('¡Registro completado! Gracias por completar su Ficha de Datos.');
          window.location.reload();
        } catch(error) {
          console.error('Error:',error);
          alert('Hubo un error. Intente nuevamente.');
        }
      };

      const Section = ({title,icon:Icon,children,expanded,onToggle}) => (
        <div className="bg-white rounded-xl shadow-md overflow-hidden border border-gray-200 hover:shadow-lg transition-shadow">
          <button type="button" onClick={onToggle} className="w-full flex items-center justify-between p-5 bg-[#0973b0] text-white hover:bg-[#075a90] transition-colors">
            <div className="flex items-center gap-3">
              <div className="bg-white p-2 rounded-lg"><Icon className="text-[#0973b0]" size={20}/></div>
              <h3 className="text-lg font-semibold">{title}</h3>
            </div>
            {expanded?<ChevronUp size={24}/>:<ChevronDown size={24}/>}
          </button>
          {expanded && <div className="p-6 bg-white">{children}</div>}
        </div>
      );

      const FormInput = ({label,required,type='text',name,onChange,...props}) => (
        <div>
          <label className="block text-sm font-medium text-gray-700 mb-2">{label}: {required&&<span className="text-red-600">*</span>}</label>
          <input name={name} type={type} onChange={onChange} className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#0973b0] focus:border-transparent transition" {...props}/>
        </div>
      );

      const FileUpload = ({label,required,onClick,onChange,selected,keyName,fileInputRef}) => (
        <div className="border-2 border-dashed border-gray-300 rounded-lg p-4 hover:border-[#0973b0] transition flex items-center gap-4">
          <div className="flex-1">
            <label className="block text-sm font-medium text-gray-700 mb-2">{label}: {required&&<span className="text-red-600">*</span>}</label>
            <div className="flex items-center gap-3">
              <button type="button" onClick={onClick} className="px-4 py-2 bg-[#0973b0] text-white rounded-lg hover:bg-[#075a90] transition text-sm flex items-center gap-2">
                <Paperclip size={16}/> Seleccionar archivo
              </button>
              <span className="text-sm text-gray-500">{selected||'Ningún archivo seleccionado'}</span>
            </div>
          </div>
          <input ref={fileInputRef} type="file" name={keyName} onChange={onChange} className="hidden"/>
        </div>
      );

      return (
        <form onSubmit={handleSubmit} className="min-h-screen bg-white">
          <div className="bg-[#0973b0] text-white py-6 px-4 shadow-lg">
            <div className="max-w-6xl mx-auto text-center">
              <h1 className="text-3xl font-bold mb-1">Ficha de Registro de Datos</h1>
              <p className="text-white/90 text-lg">Empresa Comunal de Servicios Múltiples</p>
              <p className="text-white/90 font-medium">Comunidad Campesina de Taca</p>
            </div>
          </div>

          <div className="max-w-6xl mx-auto px-4 py-6">
            <div className="bg-gray-50 border-l-4 border-[#0973b0] p-4 rounded-r-lg shadow-sm">
              <div className="flex items-start">
                <AlertCircle className="text-[#0973b0] mr-3 mt-0.5 flex-shrink-0" size={22}/>
                <div className="text-sm space-y-1">
                  <p><span className="text-red-600 font-bold">(*)</span> Campos obligatorios</p>
                  <p className="text-gray-700">Complete todos los campos requeridos para activar su registro</p>
                </div>
              </div>
            </div>
          </div>

          <div className="max-w-6xl mx-auto px-4 pb-12 space-y-4">
            
            {/* I. DATOS GENERALES */}
            <Section title="I. Datos Generales" icon={Building2} expanded={expandedSections.includes(0)} onToggle={()=>toggleSection(0)}>
              <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">Área/Departamento: <span className="text-red-600">*</span></label>
                  <select name="area" onChange={handleChange} className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#0973b0]">
                    <option value="">-- Seleccione --</option>
                    <option>Administración</option>
                    <option>Recursos Humanos</option>
                    <option>Operaciones</option>
                    <option>Servicios Generales</option>
                    <option>Logística</option>
                  </select>
                </div>
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">Fuente de Reclutamiento: <span className="text-red-600">*</span></label>
                  <div className="flex flex-wrap gap-3">
                    {['Facebook','Referido','Indeed','LinkedIn','Computrabajo'].map(s=>(
                      <label key={s} className="inline-flex items-center">
                        <input type="radio" name="fuente" value={s} onChange={handleChange} className="text-[#0973b0] focus:ring-[#0973b0]"/>
                        <span className="ml-2 text-sm">{s}</span>
                      </label>
                    ))}
                    <label className="inline-flex items-center">
                      <input type="radio" name="fuente" value="Otro" onChange={handleChange} className="text-[#0973b0]"/>
                      <span className="ml-2 text-sm">Otro:</span>
                      <input type="text" name="fuente_otro" onChange={handleChange} className="ml-2 px-3 py-1 border rounded-md text-sm" placeholder="Especificar"/>
                    </label>
                  </div>
                </div>
              </div>
            </Section>

            {/* II. DATOS PERSONALES */}
            <Section title="II. Datos Personales" icon={User} expanded={expandedSections.includes(1)} onToggle={()=>toggleSection(1)}>
              <div className="space-y-6">
                <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                  <FormInput label="Apellido Paterno" name="apellido_paterno" onChange={handleChange} required/>
                  <FormInput label="Apellido Materno" name="apellido_materno" onChange={handleChange} required/>
                  <FormInput label="Nombres" name="nombres" onChange={handleChange} required/>
                </div>
                <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                  <FormInput label="DNI" name="dni" type="number" onChange={handleChange} required/>
                  <FormInput label="Teléfono Fijo" name="telefono_fijo" type="tel" onChange={handleChange}/>
                  <FormInput label="Email" name="correo" type="email" onChange={handleChange} required/>
                </div>
                <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                  <FormInput label="Celular 1" name="celular1" type="tel" onChange={handleChange} required/>
                  <FormInput label="Celular 2" name="celular2" type="tel" onChange={handleChange}/>
                </div>
                <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                  <FormInput label="Fecha de Nacimiento" name="fecha_nacimiento" type="date" onChange={handleChange} required/>
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">Género: <span className="text-red-600">*</span></label>
                    <div className="flex gap-4">
                      {['Femenino','Masculino','Prefiero no decir'].map(g=>(
                        <label key={g} className="inline-flex items-center">
                          <input type="radio" name="genero" value={g} onChange={handleChange} className="text-[#0973b0]"/>
                          <span className="ml-2">{g}</span>
                        </label>
                      ))}
                    </div>
                  </div>
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">Estado Civil: <span className="text-red-600">*</span></label>
                    <div className="flex flex-wrap gap-3">
                      {['Soltero','Casado','Viudo','Divorciado'].map(e=>(
                        <label key={e} className="inline-flex items-center">
                          <input type="radio" name="estado_civil" value={e} onChange={handleChange} className="text-[#0973b0]"/>
                          <span className="ml-2 text-sm">{e}</span>
                        </label>
                      ))}
                    </div>
                  </div>
                </div>
                <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">Lugar de Nacimiento: <span className="text-red-600">*</span></label>
                    <select name="lugar_nacimiento" onChange={handleChange} className="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-[#0973b0]">
                      <option value="">-- Seleccione --</option>
                      <option>Lima</option><option>Cusco</option><option>Arequipa</option><option>Puno</option><option>Ayacucho</option>
                    </select>
                  </div>
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">Dirección Actual: <span className="text-red-600">*</span></label>
                    <textarea name="direccion" onChange={handleChange} className="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-[#0973b0]" rows={2} placeholder="Av. Los Almendros 123..."/>
                  </div>
                </div>
                <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">Banco: <span className="text-red-600">*</span></label>
                    <div className="flex gap-4">
                      {['BCP','Scotiabank','Otros'].map(b=>(
                        <label key={b} className="inline-flex items-center">
                          <input type="radio" name="banco" value={b} onChange={handleChange} className="text-[#0973b0]"/>
                          <span className="ml-2">{b}</span>
                        </label>
                      ))}
                    </div>
                  </div>
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">Sistema Pensionario: <span className="text-red-600">*</span></label>
                    <div className="flex gap-4">
                      {['ONP','AFP'].map(p=>(
                        <label key={p} className="inline-flex items-center">
                          <input type="radio" name="pension" value={p} onChange={handleChange} className="text-[#0973b0]"/>
                          <span className="ml-2">{p}</span>
                        </label>
                      ))}
                    </div>
                  </div>
                </div>
                <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">Licencia de Conducir:</label>
                    <select name="licencia" onChange={handleChange} className="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-[#0973b0]">
                      <option value="">-- Seleccione --</option>
                      <option>A-I</option><option>A-IIa</option><option>A-IIb</option><option>A-IIIa</option><option>A-IIIb</option><option>A-IIIc</option>
                    </select>
                  </div>
                  <FormInput label="Talla de Zapatos" name="talla_zapatos" onChange={handleChange}/>
                  <FormInput label="Talla de Ropa" name="talla_ropa" onChange={handleChange}/>
                </div>
              </div>
            </Section>

            {/* III. DATOS FAMILIARES */}
            <Section title="III. Datos Familiares" icon={Users} expanded={expandedSections.includes(2)} onToggle={()=>toggleSection(2)}>
              <div className="space-y-6">
                <div className="bg-gray-50 p-4 rounded-lg">
                  <div className="flex justify-between items-center mb-4">
                    <h4 className="font-medium">Datos de Familiares <span className="text-red-600">*</span></h4>
                    <button type="button" onClick={()=>setFamiliares(p=>[...p,{id:p.length+1}])} className="px-4 py-2 bg-[#0973b0] text-white rounded-lg hover:bg-[#075a90] text-sm">+ Agregar</button>
                  </div>
                  {familiares.map((fam,idx)=>(
                    <div key={fam.id} className="mb-6 pb-6 border-b last:border-0">
                      <div className="flex justify-between mb-3">
                        <span className="text-sm font-semibold">Familiar {idx+1}</span>
                        {familiares.length>1&&<button type="button" onClick={()=>setFamiliares(p=>p.filter(f=>f.id!==fam.id))} className="text-red-600 text-sm">Eliminar</button>}
                      </div>
                      <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <FormInput label="Nombres" name={`familiar_${fam.id}_nombres`} onChange={handleChange} required/>
                        <FormInput label="Apellido Paterno" name={`familiar_${fam.id}_apellido_paterno`} onChange={handleChange} required/>
                        <FormInput label="Apellido Materno" name={`familiar_${fam.id}_apellido_materno`} onChange={handleChange} required/>
                      </div>
                      <div className="grid grid-cols-1 md:grid-cols-3 gap-4 mt-4">
                        <FormInput label="DNI" name={`familiar_${fam.id}_dni`} type="number" onChange={handleChange} required/>
                        <div>
                          <label className="block text-sm font-medium text-gray-700 mb-2">Parentesco: <span className="text-red-600">*</span></label>
                          <select name={`familiar_${fam.id}_parentesco`} onChange={handleChange} className="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-[#0973b0]">
                            <option value="">-- Seleccione --</option>
                            <option>Cónyuge</option><option>Hijo/a</option><option>Padre</option><option>Madre</option><option>Hermano/a</option>
                          </select>
                        </div>
                        <FormInput label="Fecha de Nacimiento" name={`familiar_${fam.id}_fecha_nacimiento`} type="date" onChange={handleChange} required/>
                      </div>
                    </div>
                  ))}
                </div>

                <div className="bg-gray-50 p-4 rounded-lg">
                  <div className="flex justify-between items-center mb-4">
                    <h4 className="font-medium">Contactos de Emergencia <span className="text-red-600">*</span></h4>
                    <button type="button" onClick={()=>setContactosEmergencia(p=>[...p,{id:p.length+1}])} className="px-4 py-2 bg-[#0973b0] text-white rounded-lg hover:bg-[#075a90] text-sm">+ Agregar</button>
                  </div>
                  {contactosEmergencia.map((cont,idx)=>(
                    <div key={cont.id} className="mb-6 pb-6 border-b last:border-0">
                      <div className="flex justify-between mb-3">
                        <span className="text-sm font-semibold">Contacto {idx+1}</span>
                        {contactosEmergencia.length>1&&<button type="button" onClick={()=>setContactosEmergencia(p=>p.filter(c=>c.id!==cont.id))} className="text-red-600 text-sm">Eliminar</button>}
                      </div>
                      <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <FormInput label="Nombres y Apellidos" name={`contacto_${cont.id}_nombre`} onChange={handleChange} required/>
                        <div>
                          <label className="block text-sm font-medium text-gray-700 mb-2">Vínculo: <span className="text-red-600">*</span></label>
                          <select name={`contacto_${cont.id}_vinculo`} onChange={handleChange} className="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-[#0973b0]">
                            <option value="">-- Seleccione --</option>
                            <option>Cónyuge</option><option>Padre/Madre</option><option>Hermano/a</option><option>Amigo/a</option>
                          </select>
                        </div>
                        <FormInput label="Celular" name={`contacto_${cont.id}_celular`} type="tel" onChange={handleChange} required/>
                      </div>
                    </div>
                  ))}
                </div>

                <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                  <FormInput label="Personas a cargo" name="personas_cargo" type="number" onChange={handleChange}/>
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">¿Familiares en la empresa?</label>
                    <select name="familiares_empresa" onChange={handleChange} className="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-[#0973b0]">
                      <option value="">-- Seleccione --</option>
                      <option>Ninguno</option><option>1</option><option>2</option><option>3 o más</option>
                    </select>
                  </div>
                </div>
              </div>
            </Section>

            {/* IV. NIVEL DE INSTRUCCIÓN */}
            <Section title="IV. Nivel de Instrucción" icon={GraduationCap} expanded={expandedSections.includes(3)} onToggle={()=>toggleSection(3)}>
              <div className="space-y-6">
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-3">Nivel: <span className="text-red-600">*</span></label>
                  <div className="flex gap-4">
                    {['Secundaria','Técnico','Superior'].map(n=>(
                      <label key={n} className="inline-flex items-center">
                        <input type="radio" name="nivel" value={n} onChange={handleChange} className="text-[#0973b0]"/>
                        <span className="ml-2">{n}</span>
                      </label>
                    ))}
                  </div>
                </div>

                <div className="bg-gray-50 p-4 rounded-lg">
                  <div className="flex justify-between items-center mb-4">
                    <h4 className="font-medium">Datos Académicos</h4>
                    <button type="button" onClick={()=>setEstudios(p=>[...p,{id:p.length+1}])} className="px-4 py-2 bg-[#0973b0] text-white rounded-lg hover:bg-[#075a90] text-sm">+ Agregar</button>
                  </div>
                  {estudios.map((est,idx)=>(
                    <div key={est.id} className="mb-6 pb-6 border-b last:border-0">
                      <div className="flex justify-between mb-3">
                        <span className="text-sm font-semibold">Estudio {idx+1}</span>
                        {estudios.length>1&&<button type="button" onClick={()=>setEstudios(p=>p.filter(e=>e.id!==est.id))} className="text-red-600 text-sm">Eliminar</button>}
                      </div>
                      <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <FormInput label="Centro de Estudios" name={`estudio_${est.id}_centro`} onChange={handleChange} required/>
                        <FormInput label="Carrera" name={`estudio_${est.id}_carrera`} onChange={handleChange} required/>
                        <FormInput label="Duración (Años)" name={`estudio_${est.id}_duracion`} type="number" onChange={handleChange} required/>
                      </div>
                      <div className="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
                        <FormInput label="Fecha Ingreso" name={`estudio_${est.id}_ingreso`} type="date" onChange={handleChange} required/>
                        <FormInput label="Fecha Egreso" name={`estudio_${est.id}_egreso`} type="date" onChange={handleChange} required/>
                      </div>
                    </div>
                  ))}
                </div>
              </div>
            </Section>

            {/* V. EXPERIENCIA LABORAL */}
            <Section title="V. Experiencia Laboral" icon={Briefcase} expanded={expandedSections.includes(4)} onToggle={()=>toggleSection(4)}>
              <div className="space-y-6">
                <label className="inline-flex items-center">
                  <input type="checkbox" name="sin_experiencia" onChange={handleChange} className="text-[#0973b0] rounded"/>
                  <span className="ml-2 font-medium">Sin Experiencia Laboral</span>
                </label>

                <div className="bg-gray-50 p-4 rounded-lg">
                  <div className="flex justify-between items-center mb-4">
                    <h4 className="font-medium">Experiencia Anterior</h4>
                    <button type="button" onClick={()=>setExperiencias(p=>[...p,{id:p.length+1}])} className="px-4 py-2 bg-[#0973b0] text-white rounded-lg hover:bg-[#075a90] text-sm">+ Agregar</button>
                  </div>
                  {experiencias.map((exp,idx)=>(
                    <div key={exp.id} className="mb-6 pb-6 border-b last:border-0">
                      <div className="flex justify-between mb-3">
                        <span className="text-sm font-semibold">Experiencia {idx+1}</span>
                        {experiencias.length>1&&<button type="button" onClick={()=>setExperiencias(p=>p.filter(e=>e.id!==exp.id))} className="text-red-600 text-sm">Eliminar</button>}
                      </div>
                      <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <FormInput label="Organización" name={`exp_${exp.id}_org`} onChange={handleChange}/>
                        <FormInput label="Cargo" name={`exp_${exp.id}_cargo`} onChange={handleChange}/>
                        <FormInput label="Tiempo (meses)" name={`exp_${exp.id}_tiempo`} type="number" onChange={handleChange}/>
                      </div>
                      <div className="mt-4">
                        <label className="block text-sm font-medium text-gray-700 mb-2">Motivo de Cese:</label>
                        <textarea name={`exp_${exp.id}_motivo`} onChange={handleChange} className="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-[#0973b0]" rows={2}/>
                      </div>
                      <div className="grid grid-cols-1 md:grid-cols-3 gap-4 mt-4">
                        <FormInput label="Jefe Inmediato" name={`exp_${exp.id}_jefe`} onChange={handleChange}/>
                        <FormInput label="Cargo del Jefe" name={`exp_${exp.id}_cargo_jefe`} onChange={handleChange}/>
                        <FormInput label="Teléfono" name={`exp_${exp.id}_telefono_jefe`} type="tel" onChange={handleChange}/>
                      </div>
                    </div>
                  ))}
                </div>
              </div>
            </Section>

            {/* VI. ADJUNTOS */}
            <Section title="VI. Adjuntos" icon={Paperclip} expanded={expandedSections.includes(5)} onToggle={()=>toggleSection(5)}>
              <div className="space-y-4">
                <FileUpload label="DNI (frente)" required keyName="dni_frente" fileInputRef={r=>fileInputRefs.current.dni_frente=r} onClick={()=>handleFileClick('dni_frente')} onChange={e=>handleFileChange('dni_frente',e)} selected={attachments.dni_frente}/>
                <FileUpload label="DNI (reverso)" keyName="dni_reverso" fileInputRef={r=>fileInputRefs.current.dni_reverso=r} onClick={()=>handleFileClick('dni_reverso')} onChange={e=>handleFileChange('dni_reverso',e)} selected={attachments.dni_reverso}/>
                <FileUpload label="CV Documentado" required keyName="cv" fileInputRef={r=>fileInputRefs.current.cv=r} onClick={()=>handleFileClick('cv')} onChange={e=>handleFileChange('cv',e)} selected={attachments.cv}/>
                <FileUpload label="Certificado de Vacunación" required keyName="vacuna" fileInputRef={r=>fileInputRefs.current.vacuna=r} onClick={()=>handleFileClick('vacuna')} onChange={e=>handleFileChange('vacuna',e)} selected={attachments.vacuna}/>
                <FileUpload label="CERTIADULTO" keyName="certiadulto" fileInputRef={r=>fileInputRefs.current.certiadulto=r} onClick={()=>handleFileClick('certiadulto')} onChange={e=>handleFileChange('certiadulto',e)} selected={attachments.certiadulto}/>
              </div>
            </Section>

            {/* VII. TÉRMINOS */}
            <Section title="VII. Términos y Condiciones" icon={CheckCircle} expanded={expandedSections.includes(6)} onToggle={()=>toggleSection(6)}>
              <div className="bg-gray-50 p-6 rounded-lg">
                <label className="flex items-start">
                  <input type="checkbox" name="acepta_terminos" onChange={handleChange} className="mt-1 text-[#0973b0] rounded" required/>
                  <span className="ml-3 text-sm">Acepto los términos y condiciones <span className="text-red-600">*</span>
                    <p className="mt-2 text-gray-600">Autorizo a la Empresa Comunal de Servicios Múltiples de la Comunidad Campesina de Taca a utilizar mis datos personales para fines de gestión de recursos humanos, conforme a la Ley N° 29733.</p>
                  </span>
                </label>
              </div>
            </Section>

            {/* SUBMIT */}
            <div className="pt-6">
              <button type="submit" className="w-full bg-[#0973b0] text-white py-4 px-6 rounded-lg hover:bg-[#075a90] transition-all shadow-lg font-medium text-lg flex items-center justify-center gap-2">
                <CheckCircle size={20}/> Registrar Información
              </button>
            </div>
          </div>
        </form>
      );
    }

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<FichaDatos />);
  </script>
</body>
</html>